#+TITLE:     SICP-CH2-æ„é€ æ•°æ®æŠ½è±¡
#+AUTHOR:    Tsubasa
#+EMAIL:     tsubasa.wp@gmail.com
#+DATE:      2016-04-05
#+STARTUP:   latexpreview

* æ•°æ®æŠ½è±¡ç´¢å¼•
=æ•°æ®æŠ½è±¡= æ˜¯ä¸€ç§ç§‘å­¦æ–¹æ³•,å®ƒä½¿æˆ‘ä»¬èƒ½å°†ä¸€ä¸ªå¤åˆæ•°æ®å¯¹è±¡çš„ä½¿ç”¨,ä¸è¯¥æ•°æ®å¯¹è±¡æ€æ ·ç”±æ›´åŸºæœ¬çš„æ•°æ®å¯¹è±¡æ„é€ èµ·æ¥çš„ç»†èŠ‚éš”ç¦»å¼€.

** å®ä¾‹:æœ‰ç†æ•°çš„ç®—æœ¯è¿ç®—
=è¡¨æ•°æ®ç»“æ„= ä»åºå¯¹æ„é€ èµ·æ¥çš„æ•°æ®å¯¹è±¡

å…³é”®å­—:cond, car, cdr

å®šä¹‰æœ‰ç†æ•°è¿‡ç¨‹:
: ;; å®šä¹‰æœ‰ç†æ•°å¹¶ç”¨gcdä¼˜åŒ–
: (define (make-rat n d)
:   (let ((g (gcd n d)))
:     (cons (/ n g)  (/ d g))))
: ;; åˆ†å­
: (define (number x) (car x))
: ;; åˆ†æ¯
: (define (denom x) (cdr x))
: ;; print
: (define (print-rat x)
:   (newline)
:   (display (number x))
:   (display "/")
:   (display (denom x)))
: ;; test val->1/2
: (print-rat (make-rat 2 -4))
: 
:

** ä¹ é¢˜2.1
: (define (make-rat n d)
:   (let ((g (gcd (abs n) (abs d))))
:     (cond ((> (* n d) 0)
:            (cons (/ (abs n) g)  (/ (abs d) g)))
:           (else  (cons (- 0 (/ (abs n) g)) (/ (abs d) g))))))

** æŠ½è±¡å±éšœ
æ•°æ®æŠ½è±¡çš„åŸºæœ¬æ€æƒ³æ˜¯:ä¸ºæ¯ä¸€ç±»æ•°æ®å¯¹è±¡æ ‡è¯†å‡ºä¸€ç»„æ“ä½œ,ä½¿å¾—å¯¹è¿™ç±»æ•°æ®å¯¹è±¡çš„æ“ä½œéƒ½å¯ä»¥åŸºäºå®ƒä»¬è¡¨è¿°,å¹¶ä¸”åªä½¿ç”¨å®ƒä»¬.
** ä¹ é¢˜2.2
: (define (make-point x y) (cons x y))
: (define (x-point x) (car x))
: (define (y-point x) (cdr x))
: (define (make-segment x y) (cons x y))
: (define (start-point x) (car x))
: (define (end-point x) (cdr x))
: (define (print-point p)
:   (newline)
:   (display "(")
:   (display (x-point p))
:   (display ",")
:   (display (y-point p))
:   (display ")"))
: 
: (define (mid-point segment)
:   (print-point (make-point
:    (/ (+ (x-point (start-point segment)) (x-point (end-point segment))) 2)
:    (/ (+ (y-point (start-point segment)) (y-point (end-point segment))) 2))))
: 
: (mid-point (make-segment (make-point 1.0 1.0) (make-point 4 5)))
: ;; value-> (2.5,3.)

** ä¹ é¢˜2.3
: (define (double x) (* x x))
: (define (make-rect p1 p2 p3)
:   (cons (make-segment p1 p2) (make-segment p2 p3)))
: (define (h-side rect) (car rect))
: (define (v-side rect) (cdr rect))
: (define (lenth seg)
:   (let ((p1 (x-point seg))
:         (p2 (y-point seg)))
:   (sqrt
:    (+
:     (double (- (x-point p1) (x-point p2)))
:     (double (- (y-point p1) (y-point p2)))))))
: (define (rect-length rect)
:   (* (+
:       (lenth (h-side rect))
:       (lenth (v-side rect)))
:      2))
: (define (rect-area rect)
:   (*  (lenth (h-side rect))
:       (lenth (v-side rect))))
: 
: ;; test
: (lenth (make-segment (make-point 1 1) (make-point 2 2))) 
: ;Value: 1.4142135623730951
: 
: (rect-length
:  (make-rect (make-point 1 1) (make-point 2 2) (make-point 0 2))) 
: ;Value: 6.82842712474619
: 
: (rect-area
:  (make-rect (make-point 1 1) (make-point 2 2) (make-point 0 2))) 
: ;Value: 2.8284271247461903

** æ•°æ®æ„å‘³ç€ä»€ä¹ˆ
=æ•°æ®= æ˜¯ä¸€ç»„é€‚å½“çš„ *æ„é€ å‡½æ•°* å’Œ *é€‰æ‹©å‡½æ•°* ,ä»¥åŠä¸ºäº†ä½¿è¿™äº›è¿‡ç¨‹æˆä¸ºä¸€å¥—åˆæ³•çš„è¡¨ç¤º, å®ƒä»¬å¿…é¡»æ»¡è¶³çš„ä¸€ç»„*ç‰¹å®šæ¡ä»¶*

æ¡ä»¶å¯èƒ½ä¸å¤ªå¥½ç†è§£, ä¸¾ä¾‹æ¥è¯´, *åºå¯¹* è¿™ç§æ•°æ®çš„carå’Œcdræ“ä½œéœ€è¦æ»¡è¶³çš„æ¡ä»¶å°±æ˜¯:
ä»»ä½•å¯¹è±¡xå’Œy, å¦‚æœzæ˜¯(cons x y),é‚£ä¹ˆ(car z)å°±æ˜¯x, (cdr z)å°±æ˜¯y.

=æ•°æ®çš„è¿‡ç¨‹æ€§è¡¨ç¤º= lisp/schemeç”šè‡³å¯ä»¥ç”¨è¿‡ç¨‹æ¥è¡¨ç¤ºåºå¯¹:
: (define (cons x y)
:  (define (dispatch m)
:    (cond ((= m 0) x)
:          ((= m 1) y)
:          (else (error "argument not 0 or 1")))
:   dispatch))
: 
: (define (car z) (z 0))
: (define (cdr z) (z 1))

(cons x y)è¿”å›ä¸€ä¸ªè¿‡ç¨‹. å½“ç„¶schemeå’Œä¸€èˆ¬çš„lispå¹¶ä¸ä¼šè¿™æ ·å®ç°åºå¯¹,ä¸»è¦æ˜¯å‡ºäºæ€§èƒ½è€ƒè™‘.

åœ¨ç¬¬ä¸‰ç« å¯ä»¥çœ‹åˆ°,æ•°æ®çš„è¿‡ç¨‹æ€§è¡¨ç¤ºåœ¨è®¾è®¡ä¸­æ‰®æ¼”ç€ä¸€ç§é‡è¦çš„è§’è‰²,è¿™ç§é£æ ¼å«åš =æ¶ˆæ¯ä¼ é€’=

** ä¹ é¢˜2.4
ä»£æ¢è¿‡ç¨‹:
: (car (cons x y))
: ((cons x y) (lambda (p q) p))
: ;æŠŠ(lambda (p q))ä½œä¸ºmå¸¦å…¥(lambda (m) (m x y))
: ((lambda (p q) p) x y)
: ;åº”ç”¨x,y,å¾—åˆ°
: value->x

** ä¹ é¢˜2.5
2å’Œ3éƒ½æ˜¯è´¨æ•°,å¯ä»¥åˆ©ç”¨è´¨æ•°ç›¸ä¹˜çš„æ€§è´¨å‚¨å­˜aå’Œb.
: (define (cons-expt x y)
:   (* (expt 2 x) (expt 3 y)))
:
: (define (car-expt x)
:   (define (iter a n)
:     (cond ((= 0 (remainder a 2)) (iter (/ a 2) (+ n 1)))
:           (else n)))
:   (iter x 0))
: 
: (define (cdr-expt x)
:   (define (iter a n)
:     (cond ((= 0 (remainder a 3)) (iter (/ a 3) (+ n 1)))
:           (else n)))
:   (iter x 0))
: 
: (car-expt (cons-expt 5 6)) ;value->5
: (cdr-expt (cons-expt 5 6)) ;value->6

** ä¹ é¢˜2.6
ä½¿ç”¨churchè®¡æ•°çš„è¡¨ç¤ºå½¢å¼å®šä¹‰oneå’Œtwo. (è®²çœŸæˆ‘å¯¹ç€è¿™é“é¢˜å‘å‘†å¥½ä¹…....

: (define zero (lambda (f) (lambda (x) x)))
: (define (add-1 n)
:   (lambda (f) (lambda (x) (f (n f) x))))
: 
: ; é¦–å…ˆå±•å¼€add-1
: (add-1 zero)
: (lambda (f) (lambda (x) (f ((zero f) x))))
: (lambda (f) (lambda (x) (f ((lambda(x) x) x))))
: (lambda (f) (lambda (x) (f x)))
: (add-1 one)
: (lambda (f) (lambda (x) (f ((one f) x))))
: (lambda (f) (lambda (x) (f ((lambda (x) (f x)) x))))
: (lambda (f) (lambda (x) (f (f x))))
: ; å®šä¹‰one
: (define one (lambda (f) (lambda (x) (f x))))
: ; å®šä¹‰two
: (define two (lambda (f) (lambda (x) (f (f x)))))
: ;æ ¹æ®è§‚å¯Ÿå¾—å‡ºè§„å¾‹è§„å¾‹:oneçš„å®šä¹‰ä¸­åº”ç”¨äº†ä¸€æ¬¡f, twoçš„å®šä¹‰ä¸­åº”ç”¨äº†2æ¬¡f, æ‰€ä»¥è¿™ç±»è¿‡ç¨‹å¯ä»¥ç†è§£ä¸ºç”¨'åº”ç”¨fçš„æ¬¡æ•°'æ¥è¡¨ç¤ºæ•°å­—.
å®šä¹‰é€šç”¨çš„åŠ æ³•:
: (define (add a b)
:   (lambda(f) (lambda(x) ((a f) ((b f) x)))))
è¿™ä¸ªå®šä¹‰çš„æ€è·¯æ˜¯æŠŠaå’Œbä¸­åº”ç”¨fçš„è¿‡ç¨‹å åŠ . ä¸‹é¢æµ‹è¯•ä¸€ä¸‹:
: (add one two)
: (lambda(f) (lambda(x) ((lambda(x) (f x)) ((lambda(x) (f (f x))) x))))
: (lambda(f) (lambda(x) ((lambda(x) (f x)) (f (f x)))))
: (lambda(f) (lambda(x) (f (f (f x)))))

** æ‰©å±•ç»ƒä¹ :åŒºé—´ç®—æœ¯

** ä¹ é¢˜2.7
: (define (make-interval a b) (cons a b))
: (define (upper-bound x) (car x))
: (define (lower-bound x) (cdr x))

** ä¹ é¢˜2.8
: (define (sub-interval a b)
:   (make-interval (- (upper-bound a) (upper-bound b))
:                  (- (lower-bound a) (lower-bound b))))

** ä¹ é¢˜2.9
å¯¹åŠ /å‡è¿ç®—è€Œè¨€:
$w(a+b)=(u(a+b)-l(a+b))/2=(((u(a)+u(b))-(l(a)+l(b)))/2=(w(a)+w(b))$
æ‰€ä»¥ä¸¤ä¸ªåŒºé—´çš„å’Œ/å·®çš„å®½åº¦å‡½æ•°å°±æ˜¯è¢«åŠ /å‡çš„åŒºé—´çš„å®½åº¦å‡½æ•°.

å¯¹ä¹˜æ³•è€Œè¨€:

æœ‰åŒºé—´A=[0,2],å®½åº¦ä¸º1;B=[0,4],å®½åº¦ä¸º2;
A*B=[0,8],å®½åº¦ä¸º4. æ‰€ä»¥$w(A*B)\neq w(A)*w(B)$.

å¯¹é™¤æ³•è€Œè¨€:
A/B=[0,1/2],å®½åº¦ä¸º1/4. è€Œw(A)/w(B)=1/2; æ‰€ä»¥$w(A/B)\neq w(A)/w(B)$.

** ä¹ é¢˜2.10
: ; é¦–å…ˆå®šä¹‰ä¸€ä¸ªæ£€æŸ¥è¿‡ç¨‹
: (define (valid-interval x)
:   (if (< (* (upper-bound x) (lower-bound x)) 0) false true))
: ; é‡æ–°å®šä¹‰é™¤æ³•
: (define (div-interval x y)
:   (if (and (valid-interval x) (vali-interval y))
:       (mul-interval x
:                     (make-interval (/ 1.0 (upper-bound y))
:                                    (/ 1.0 (lower-bound y))))
:       (display "error:invalid param")))

** ä¹ é¢˜2.11
æ ¹æ®åŒºé—´æ˜¯å¦è·¨è¿‡0|æ˜¯å¦å…¨ä¸ºæ­£|æ˜¯å¦å…¨ä¸ºè´Ÿåˆ†ä¸º9ç§æƒ…å†µ.
- a > 0, b > 0
- a > 0, b < 0
- a > 0, b cross 0
- a cross 0, b > 0
- a cross 0, b < 0
- a cross 0, b cross 0
- a < 0, b > 0
- a < 0, b < 0
- a < 0, b cross 0

å®šä¹‰å¿«é€Ÿä¹˜æ³•(æœ‰ä¸ªé—®é¢˜..å½“aå’Œbéƒ½è·¨è¶Š0æ—¶,éœ€è¦4æ¬¡ä¹˜æ³•è¿ç®—)
: (define (is-cross-zero x)
:   (if (< (* (upper-bound x) (lower-bound x)) 0) true false))
: (define (is-positive x)
:   (if (>= (lower-bound x) 0) true false))
: (define (is-negative x)
:   (if (< (upper-bound x) 0) true false))
: 
: (define (fast-mul-interval x y)
:   (cond
:    ((and (is-positive x) (is-positive y))
:     (make-interval
:      (* (lower-bound x) (lower-bound y))
:      (* (upper-bound x) (upper-bound y))))
:    ((and (is-positive x) (is-negative y))
:     (make-interval
:      (* (upper-bound x) (upper-bound y))
:      (* (lower-bound x) (lower-bound y))))
:    ((and (is-positive x) (is-cross-zero y))
:     (make-interval
:      (* (upper-bound x) (lower-bound y))
:      (* (upper-bound x) (upper-bound y))))
:    ((and (is-negative x) (is-positive y))
:     (make-interval
:      (* (lower-bound x) (upper-bound y))
:      (* (upper-bound x) (lower-bound y))))
:    ((and (is-negative x) (is-negative y))
:     (make-interval
:      (* (upper-bound x) (upper-bound y))
:      (* (lower-bound x) (lower-bound y))))
:    ((and (is-negative x) (is-cross-zero y))
:     (make-interval
:      (* (lower-bound x) (upper-bound y))
:      (* (lower-bound x) (lower-bound y))))
:    ((and (is-cross-zero x) (is-positive y))
:     (make-interval
:      (* (lower-bound x) (upper-bound y))
:      (* (upper-bound x) (upper-bound y))))
:    ((and (is-cross-zero x) (is-negative y))
:    (make-interval
:     (* (upper-bound x) (lower-bound y))
:     (* (lower-bound x) (lower-bound y))))
:   ((and (is-cross-zero x) (is-cross-zero y))
:    (make-interval
:     (min (* (lower-bound x) (upper-bound y)) (* (upper-bound x) (lower-bound y)))
:     (max (* (upper-bound x) (upper-bound y)) (* (lower-bound x) (lower-bound y)) )))))

ä¸Alyssaçš„æš´åŠ›ä¹˜æ³•è¿›è¡Œæ¯”è¾ƒæµ‹è¯•(åè¡€...
: (fast-mul-interval (make-interval 1 2) (make-interval 1 2))
: (mul-interval (make-interval 1 2) (make-interval 1 2))
: ;; Value : (1 . 4)
: 
: (fast-mul-interval (make-interval 1 2) (make-interval -1 -2))
: (mul-interval (make-interval 1 2) (make-interval -1 -2))
: ;; Value : (-4 .-1)
: 
: (fast-mul-interval (make-interval 1 2) (make-interval -1 2))
: (mul-interval (make-interval 1 2) (make-interval -1 2))
: ;; Value : (-2, 4)
: 
: (fast-mul-interval (make-interval -2 -1) (make-interval 1 2))
: (mul-interval (make-interval -2 -1) (make-interval 1 2))
: ;; Value : (-4, -1)
: 
: (fast-mul-interval (make-interval -2 -1) (make-interval -2 -1))
: (mul-interval (make-interval -2 -1) (make-interval -2 -1))
: ;; Value : (1, 4)
: 
: (fast-mul-interval (make-interval -2 -1) (make-interval -1 2))
: (mul-interval (make-interval -2 -1) (make-interval -1 2))
: ;; Value : (-4, 2)
: 
: (fast-mul-interval (make-interval -2 1) (make-interval 1 2))
: (mul-interval (make-interval -2 1) (make-interval 1 2))
: ;; Value : (-4, 2)
: 
: (fast-mul-interval (make-interval -2 1) (make-interval -2 -1))
: (mul-interval (make-interval -2 1) (make-interval -2 -1))
: ;; Value : (-2, 4)
: 
: (fast-mul-interval (make-interval -2 1) (make-interval -5 2))
: (mul-interval (make-interval -2 1) (make-interval -5 2))
: ;; Value : (-5, 10)

** ä¹ é¢˜2.12
: (define (make-center-percent center percent)
:   (make-interval (- center (* center percent))
:                  (+ center (* center percent))))
: (define (percent range)
:   (let ((width (/ (- (upper-bound range) (lower-bound range)) 2))
:         (mid (/ (+ (upper-bound range) (lower-bound range)) 2)))
:         (/ width mid)))

** ä¹ é¢˜2.13
è®¡ç®—ç²¾åº¦çš„å…¬å¼æ˜¯ç®€å•ç›¸åŠ :
: (define (percent-mul r1 r2)
:   (+ (percent r1) (percent r2)))
æµ‹è¯•ä¸€ä¸‹
: (percent (mul-interval (make-interval 9.99 10.01) (make-interval 9.99 10.01)))
: (percent-mul (make-interval 9.99 10.01) (make-interval 9.99 10.01))


ç„¶ååˆ†æpart1,part2çš„é—®é¢˜:
: (define (part1 r1 r2)
:   (div-interval (mul-interval r1 r2)
:                 (add-interval r1 r2)))
: (define (part2 r1 r2)
:   (let ((one (make-interval 1 1)))
:     (div-interval one
:                   (add-interval (div-interval one r1)
:                                 (div-interval one r2)))))
: 
: (part1 (make-interval 1 2) (make-interval 1 2)) ;val-> (.25,2)
: (part2 (make-interval 1 2) (make-interval 1 2)) ;val-> (.5 1)
çŒœæµ‹æ˜¯è¿ç®—é¡ºåºä¸åŒå¯¼è‡´ç²¾åº¦å˜åŒ–ä¸åŒ

** ä¹ é¢˜2.14
é¦–å…ˆéªŒè¯ä¸Šé¢çš„çŒœæµ‹
: (let ((r1 (make-interval 1.0 2))
:        (r2 (make-interval 1.0 2))
:       (one (make-interval 1.0 1.0)))
:   (percent r1)  ; .33
:   (percent (mul-interval r1 r2)) ; .6 æ”¾å¤§2å€
:   (percent (div-interval r1 r2)) ; .6 æ”¾å¤§2å€
:   (percent (add-interval r1 r2)) ; .33 ä¸å˜
:   (percent (div-interval one r1)) ; .33 ä¸å˜
:   (percent (part1 r1 r2)) ; .77 æ”¾å¤§2.28å€
:   (percent (part2 r1 r2)) ; .33 
:   )

å¯è§,ç›´æ¥å¯¹ä¸¤ä¸ªåŒºé—´è¿›è¡Œä¹˜æ³•æˆ–é™¤æ³•æ“ä½œä¼šå°†ç²¾åº¦æ”¾å¤§.è€ŒåŠ æ³•ä»¥åŠè¢«oneé™¤ä¸ä¼šæ”¾å¤§ç²¾åº¦.

åœ¨part1çš„è¿ç®—è¿‡ç¨‹ä¸­,ä¹˜æ³•å°†ç²¾åº¦æ”¾å¤§2å€, ç”¨æ”¾å¤§çš„ä¹˜ç§¯é™¤ä»¥å’Œä¹‹åä»0.6æ”¾å¤§åˆ°0.77. 
è€Œåœ¨part2ä¸­,ç”±äºå…¨æ˜¯é™¤ä»¥1çš„æ“ä½œ.ç²¾åº¦æ²¡æœ‰å‘ç”Ÿå˜åŒ–.

** ä¹ é¢˜2.15
evaè¯´çš„å¯¹. part2ä¸­çš„è¿ç®—éƒ½æ²¡æœ‰é€ æˆç²¾åº¦åŒºé—´æ‰©å¤§,æ‰€ä»¥æ˜¯æ›´å¥½çš„ç¨‹åº.

** ä¹ é¢˜2.16
(ä½œè€…è¯´æ­¤é¢˜éå¸¸éš¾...æ€•

æˆ‘å…ˆæƒ³åˆ°äº†é™¤æ³•è¿ç®—å¯èƒ½é•¿è¿™æ ·:
: (define (better-div-interval r1 r2)
:   (let ((one (make-interval 1 1)))
:     (better-mul-interval r1  (div-interval one r2))))
ä½†é¦–å…ˆè¦èƒ½å®šä¹‰å‡ºä¸€ä¸ªbetter-mul-interval

æˆ‘å®åœ¨ç¼–ä¸ä¸‹å»äº†! googleäº†ä¸€ä¸‹,è¿™é“é¢˜çœŸçš„å¾ˆéš¾,æ¶‰åŠåˆ°æ¯”è¾ƒè‰°æ·±çš„æ•°å­¦é—®é¢˜. è´´ä¸ªé“¾æ¥åœ¨è¿™é‡Œå§:
http://stackoverflow.com/questions/14130878/sicp-2-16-interval-arithmetic-scheme

* å±‚æ¬¡æ€§æ•°æ®å’Œé—­åŒ…æ€§è´¨
=æ“ä½œçš„é—­åŒ…æ€§è´¨= é€šè¿‡æŸç§æ“ä½œç»„åˆèµ·æ¥çš„æ•°æ®å¯¹è±¡å¾—åˆ°çš„ç»“æœæœ¬èº«è¿˜å¯ä»¥é€šè¿‡åŒæ ·çš„æ“ä½œå†è¿›è¡Œç»„åˆ.

** åºåˆ—çš„è¡¨ç¤º
åºåˆ—å¯ä»¥é€šè¿‡åµŒå¥—consæ“ä½œæ„é€ èµ·æ¥
: (cons 1
:     (cons 2
:         (cons 3
:             (cons 4 ))))

schemeä¸ºäº†æ–¹ä¾¿è¡¨çš„æ„é€ è€Œæä¾›äº†ä¸€ä¸ªåŸºæœ¬æ“ä½œlist.æ‰€ä»¥ä¸Šé¢åºåˆ—ä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼äº§ç”Ÿ:
: (list 1 2 3 4)
å®ƒä»¬æ˜¯ç­‰ä»·çš„.

*** å¯¹è¡¨çš„æ“ä½œ
=car= å¯ä»¥è¢«çœ‹åšè·å–è¡¨ç¬¬ä¸€é¡¹å…ƒç´ çš„æ“ä½œ
=cdr= å¯ä»¥çœ‹åšè·å–è¡¨å‰©ä¸‹çš„å…ƒç´ çš„æ“ä½œ
=nil= ç”¨äºè¡¨ç¤ºåºå¯¹é“¾çš„ç»“æŸ

å¯ä»¥è¿™æ ·å®ç°ç´¢å¼•:
: (define (list-ref item n)
:   (if (= n 0)
:       (car item)
:       (list-ref (cdr item) (- n 1))))

=null?= ç”¨äºæ£€æŸ¥æ˜¯å¦æ˜¯ç©ºè¡¨.
åˆ©ç”¨nullå®ç°length:
: (define (length items)
:   (if (null? items)
:       0
:       (+ 1 (length (cdr items)))))

*** ä¹ é¢˜2.17
è·å–åºåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ 
: (define (last-pair items)
:   (if (= 1 (length items))
:       (list (car items))
:       (last-pair (cdr items))))

*** ä¹ é¢˜2.18
è¿”å›é€†åºåºåˆ—
: (define (reverse items)
:   (if (= 1 (length items))
:       items
:       (append (reverse (cdr items)) (list (car items)))))

*** ä¹ é¢˜2.19
åˆ©ç”¨åºåˆ—ä¼˜åŒ–1.22çš„æ‰¾ç¡¬å¸ç¨‹åº,æŠŠå¸ç§å­˜å‚¨åœ¨åºåˆ—ä¸­
: (define us-coins (list 50 25 10 5 1))
: (define uk-coins (list 100 50 20 10 5 2 1 0.5))
: (define (except-first-denomination coin-values) (cdr coin-values))
: (define (first-denomination coin-values) (car coin-values))
: (define (no-more? coin-values) (if (null? coin-values) true false))
: (define (cc amount coin-values)
:   (cond ((= amount 0 ) 1)
:         ((or (< amount 0) (no-more? coin-values)) 0)
:         (else
:          (+ (cc amount
:                 (except-first-denomination coin-values))
:             (cc (- amount
:                    (first-denomination coin-values))
:                 coin-values)))))
å¸ç§çš„æ’åºä¸ä¼šå½±å“ç»“æœ.å› ä¸ºé’ˆå¯¹æ¯ç§ç¡¬å¸,éƒ½ä¼šä»æ€»é‡‘é¢amountå¼€å§‹é‡æ–°è®¡ç®—, æµ‹è¯•ç»“æœæ˜¯äº’ç›¸ç‹¬ç«‹çš„.

*** ä¹ é¢˜2.20
è¿™é“é¢˜è¯´æ˜äº†schemeæ€æ ·å®šä¹‰å¸¦æœ‰ä»»æ„å¤šå‚æ•°çš„è¿‡ç¨‹

å…·ä½“æ–¹å¼æ˜¯ä½¿ç”¨ç‚¹å°¾:
: (define (f x y . z) <body>)
é‚£ä¹ˆå¦‚æœæ±‚å€¼(f 1 2 3 4 5),åˆ™x=1,y=2,ç„¶åz=(3,4,5),æ˜¯ä¸€ä¸ªlist. (åŸæ¥æ˜¯è¿™æ ·...

è¯·ç”¨è¿™ç§è®°æ³•å†™å‡ºsame-parity:è¿”å›ä¸å…¶ç¬¬ä¸€ä¸ªå‚æ•°æœ‰åŒæ ·å¥‡å¶æ€§è´¨çš„è¡¨
: ;é¦–å…ˆå®šä¹‰ä¸€ä¸ªé€‰æ‹©å™¨,å®ƒæ¥å—ä¸€ä¸ªè¿‡ç¨‹å‚æ•°f,ç„¶åç”¨fæ¥è¿‡æ»¤å‡ºå­åºåˆ—
: (define (filter items f)
:   (cond
:    ((null? items) (list))
:    ((f (car items))
:     (append (list (car items)) (filter (cdr items) f)))
:    (else
:     (append (list) (filter (cdr items) f)))))
ç„¶åå®šä¹‰same-party.ä¸ºäº†ç®€åŒ–æˆ‘é¦–å…ˆåˆ©ç”¨appendæŠŠx,y,zæ•´åˆæˆä¸€ä¸ªåºåˆ—í ½í¸ƒ:
: (define (same-party x y . z)
:   (let ((param-list
:          (append (list x) (append (list y) z))))
:     (if
:      (odd? x)
:      (filter param-list odd?)
:      (filter param-list even?))))
æµ‹è¯•
: (same-party 2 1 2 3 4 5 6 7 8) ; value: (1 3 5 7)
: (same-party 1 2 3 4 5 6 7 8)   ; value: (2 2 4 6 8)

*** å¯¹è¡¨çš„æ˜ å°„
=map= æ˜¯ä¸€ç§å…¬å…±æ¨¡å¼,è€Œä¸”å»ºç«‹èµ·äº†ä¸€ç§å¤„ç†è¡¨çš„é«˜å±‚æŠ½è±¡
: (define (map proc items)
:   (if (null? items)
:       (list)
:       (cons (proc (car items))
:             (map proc (cdr items)))))

*** ä¹ é¢˜2.21
: (define (square-list items)
:   (if (null? items)
:       '()
:       (cons (square (car items)) (square-list (cdr items)))))
: 
: (define (square-list items)
:   (map square items))

*** ä¹ é¢˜2.22
ç¬¬ä¸€ä¸ªè¿­ä»£é”™åœ¨consçš„é¡ºåº,æŠŠansweræ”¾åœ¨æœ€åä¼šå˜æˆå€’åº
: (cons (...) answer)
è€Œä¿®æ”¹åçš„ç¨‹åºæŠŠansweræ”¾åœ¨å‰é¢,è™½ç„¶çœ‹èµ·æ¥é¡ºåºå¯¹äº†,ä½†consçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åµŒå¥—çš„cons,æœ€åç”Ÿæˆçš„åºåˆ—ä¼šé•¿è¿™æ ·:
: ((((. .) .) .) .)

*** ä¹ é¢˜2.23
å®ç°ä¸€ä¸ªfor-each
#+BEGIN_SRC scheme
(define (for-each proc items)
  (if (null? items)
       '()
       (begin
         (proc (car items))
         (for-each proc (cdr items)))))
#+END_SRC

** å±‚æ¬¡ç»“æ„
å°†è¡¨ä½œä¸ºåºåˆ—çš„æ–¹å¼,å¯ä»¥è‡ªç„¶çš„æ¨å¹¿åˆ°è¡¨ç¤ºé‚£äº›å…ƒç´ æœ¬èº«ä¹Ÿæ˜¯åºåˆ—çš„åºåˆ—,ä¹Ÿå°±æ˜¯
=æ ‘=. 

=pair?= schemeæä¾›çš„åŸºæœ¬è¿‡ç¨‹, æ£€æŸ¥å‚æ•°æ˜¯å¦ä¸ºåºå¯¹.

*** ä¹ é¢˜2.24
#+BEGIN_SRC scheme
(list 1 (list 2 (list 3 4) 5))
;Value 89: (1 (2 (3 4) 5))
#+END_SRC

#+BEGIN_SRC c
     N
  /     \
1        N    
       / | \  
      2  N  5
        / \
       3   4
#+END_SRC

*** ä¹ é¢˜2.25
#+BEGIN_SRC scheme
(cdr (car (cdr (cdr mt1))))
(cdr (car (cdr (car (cdr (car (cdr (car (cdr (car (cdr mt2)))))))))))
#+END_SRC

*** ä¹ é¢˜2.26
#+BEGIN_SRC scheme
(append x y) ;Value 101: (1 2 3 4 5 6)
(cons x y)   ;Value 102: ((1 2 3) 4 5 6)
(list x y)   ;Value 103: ((1 2 3) (4 5 6))
#+END_SRC

*** ä¹ é¢˜2.27
å®ç°æ·±åº¦é€†åº.è¿™é“é¢˜ç›®çœŸæ˜¯æŠ˜è…¾æ­»å®å®äº†,ä¸€å¼€å§‹æœ‰ä¸ªå…³é”®ç‚¹æ²¡ææ˜ç™½,å¯¼è‡´çå†™äº†ä¸€é€š.
è¿™ä¸ªå…³é”®çš„åœ°æ–¹æ˜¯:å¦‚æœ(cdr list)æ˜¯ä¸€ä¸ªlist:
: (list 1 (list 2 3))
é‚£ä¹ˆå®ƒçš„é€†åºåˆ™æ˜¯
: (append (cdr list) (car list))
ä½†å¦‚æœ(car list)æ˜¯list,å°±ç¨å¾®æœ‰ç‚¹ç»•:
: (list (list 1 2) 3)
é‚£ä¹ˆå®ƒçš„é€†åºåˆ™æ˜¯
: (append (cdr list) (list (car list)))
åŸå› æ˜¯appendæˆ–è€…consä¼šæŠŠç¬¬äºŒä¸ªå‚æ•°å±•å¼€(å»æ‰ä¸€å±‚list), æ‰€ä»¥ä¸èƒ½ç›´æ¥ä½¿ç”¨(car x)å½“åšç¬¬äºŒä¸ªå‚æ•°.           

æ·±åº¦é€†åº:
#+BEGIN_SRC scheme
(define (deep-revers tree)
  (cond
   ((null? tree) '())
   ((not (pair? tree)) (list tree))
   ((pair? (car tree))
      (append (deep-revers (cdr tree)) (list (deep-revers (car tree)))))
   (else
      (append (deep-revers (cdr tree)) (deep-revers (car tree))))))
#+END_SRC

*** ä¹ é¢˜2.28
#+BEGIN_SRC scheme
(define (fringe tree)
  (cond
   ((null? tree) '())
   ((not (pair? tree)) (list tree))
   (else
    (append (fringe (car tree))
            (fringe (cdr tree)))
        )))
#+END_SRC

*** ä¹ é¢˜2.29
-a) è·å–å·¦å³å­æ ‘,å³å­æ ‘ç¨ç¨æ³¨æ„:
#+BEGIN_SRC scheme
(define (make-mobile left right)
  (list left right))
(define (make-branch length structure)
  (list length structure))
(define (left-branch mobile)
  (car mobile))
(define (right-branch mobile)
  (car (cdr mobile)))
#+END_SRC

- b) é€’å½’è®¡ç®—å­æ ‘é•¿åº¦(å·¦è¾¹å¶å­ä¹‹å’Œ)
#+BEGIN_SRC scheme
(define (branch-length branch)
  (cond
   ((null? branch) 0)
   ((not (pair? branch)) 0)
   (else
    (+ (car branch) (branch-length (right-branch branch))))))
#+END_SRC

é€’å½’è®¡ç®—é‡é‡(å³å¶å­ä¹‹å’Œ)
#+BEGIN_SRC scheme
(define (branch-weight branch)
  (cond
   ((null? branch) 0)
   ((not (pair? branch)) branch)
   (else
    (branch-weight (right-branch branch)))))

(define (total-weight mobile)
  (+
   (branch-length (left-branch mobile))
   (branch-length (right-branch mobile))))
#+END_SRC

- c) è®¡ç®—æ˜¯å¦å¹³è¡¡,ç®€å•çš„ä¹˜æ³•.
#+BEGIN_SRC scheme
(define (is-balance mobile)
  (=
   (* (branch-weight (left-branch mobile)) (branch-length (left-branch mobile)))
   (* (branch-weight (left-branch mobile)) (branch-length (right-branch mobile)))))
#+END_SRC

- d) åªéœ€ä¿®æ”¹right-branchæ–¹æ³•
#+BEGIN_SRC scheme
(define (right-branch mobile)
  (cdr mobile))
#+END_SRC

*** å¯¹æ ‘çš„æ˜ å°„
æŠŠmapä¸é€’å½’ç»“åˆæ˜¯å¤„ç†æ ‘çš„ä¸€ç§å¼ºæœ‰åŠ›çš„æŠ½è±¡

*** ä¹ é¢˜2.30
å®šä¹‰square-tree
#+BEGIN_SRC scheme
å®šä¹‰square-tree
(define (map-tree tree f)
  (map (lambda (sub-tree)
         (if (pair? sub-tree)
             (map-tree sub-tree f)
             (f sub-tree)))
       tree))
(map-tree (list 1 2 (list 3 4)) square)
; value: (1 4 (9 16))
#+END_SRC

*** ä¹ é¢˜2.31
å°†2.30è¿›ä¸€æ­¥æŠ½è±¡. (è¿˜å¥½å®å®æœºæ™º,å·²ç»æŠ½è±¡å¥½äº†
: (define (square-tree tree) (map-tree tree square))

*** ä¹ é¢˜2.32
è®¡ç®—å…¨æ’åˆ—(åˆå­¦åˆ°ä¸€ç§ç®—æ’åˆ—çš„æ–°å§¿åŠ¿
#+BEGIN_SRC scheme
(define (subsets s)
  (if (null? s)
      ()
      (let ((reset (subsets (cdr s))))
        (append reset
                (cons ;; è¿™é‡Œä¸€å®šç”¨consæ¯”è¾ƒå®‰å…¨. å¦‚æœ(map..)è®¡ç®—ç»“æœæ˜¯nil, åˆ™consä¼šæŠŠnilçœç•¥è€Œlistæˆ–appendä¼šæŠŠ()æ”¾è¿›ç»“æœä¸­.
                 (car s) 
                 (map (lambda (sub) (append (car s) sub)) reset))))))
#+END_SRC
ä½œè€…é“é¢˜ä¸€å¼€å§‹appendç»“æœæ€»è·Ÿé¢„æƒ³çš„ä¸ä¸€æ ·,ç»æµ‹è¯•(append 1 2)çš„ç»“æœæ˜¯ä¸ªåºå¯¹(1 . 2)è€Œä¸æ˜¯list(1 2).
åæ¥ä¿®æ”¹äº†ä¹‹å‰çš„appendå®ç°æ‰æå®š:
#+BEGIN_SRC scheme
(define (append list1 list2)
  (cond ((null? list1)
         list2)
        ((null? list2) ;; å¯¹list2=nilçš„æƒ…å†µè¿›è¡Œå¤„ç†
         list1)
        ((and (not (pair? list1)) (not (pair? list2)))
         (list list1 list2)) ;; ä¸¤ä¸ªéƒ½æ˜¯ç®€å•æ•°æ®æ—¶è¿”å›list,è€Œä¸æ˜¯åºå¯¹
        ((not (pair? list1))
         (cons list1 list2)) ;; list1æ˜¯ç®€å•æ•°æ®æ—¶ç›´æ¥cons,å¦åˆ™åé¢ä¼šå¯¹å®ƒcar/cdr.
        (else
         (cons (car list1) (append (cdr list1) list2)))))
#+END_SRC
